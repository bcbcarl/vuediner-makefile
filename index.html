<!DOCTYPE html>
<html>
<head>
<title></title>
<!-- 2016-11-09 三 00:40 -->
<meta  charset="utf-8" />
<meta  htto-equiv="X-UA-Compatible" content="chrome=1" />
<meta  name="generator" content="Org-mode with org-ioslide" />
<meta  name="author" content="Carl Su" />


<!--<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">-->
<!--<meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--This one seems to work all the time, but really small on ipad-->
<!--<meta name="viewport" content="initial-scale=0.4">-->
<meta name="apple-mobile-web-app-capable" content="yes" />
<link rel="stylesheet" media="all" href="theme/css/default.css" />
<link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="theme/css/phone.css" />
<link rel="stylesheet" media="all" href="theme/css/small-icon.css" />
<base target="_blank"> <!-- This amazingness opens all links in a new tab. -->
<script data-main="js/slides" src="js/require-1.0.8.min.js"></script>

   <script src="js/jquery-1.7.1.min.js" type="text/javascript"></script>
</head>
<body style="opacity: 0">
<slides class="layout-widescreen">
<slide class="title-slide segue nobackground">
       <aside class="gdbar"><img src="images/vue.svg"></aside>
       <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
       <hgroup class="auto-fadein">
         <h1 data-config-title><!-- populated from slide_config.json --></h1>
         <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
         <p data-config-presenter><!-- populated from slide_config.json --></p>
       </hgroup>
    </slide>
  
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1">About Me</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<ul>
<li>Hacking Thursday 值日生</li>
<li>GitHub: <a href="https://github.com/bcbcarl">https://github.com/bcbcarl</a></li>
<li>熟悉 React, Redux, ES2015 和 Functional JavaScript</li>
<li>目前已在數個專案上使用 Makefile 管理前端開發流程</li>
</ul>

<article class="flexbox vcenter">

<div class="figure">
<p><img src="images/make-target-ac.png" alt="make-target-ac.png" width="100%" />
</p>
</div>
</article>


</article>

</slide>

</slide>
<slide id="sec-" class=" segue dark quote nobackground" style="background-image: url(nil)">
<aside class="gdbar right bottom"><img src="images/vue.svg"></aside><hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline2" class="outline-2">
<h2 id="orgheadline2">Example 1: Hello JavaScript API</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="flexbox vleft auto-fadein" id="text-">


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline3" class="outline-2">
<h2 id="orgheadline3">Requirements</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<ul>
<li>Use TypeScript to develop client-side JavaScript APIs.</li>
<li>Lint TypeScript source code when needed (e.g.: watch, build).</li>
<li>Run unit tests to check the logic of API methods.</li>
<li>Generate TAP output and generate a report after testing.</li>
<li>Support development mode by starting a dev server.
<ul>
<li>We can test these APIs under the JavaScript console.</li>
<li>Recompile APIs as soon as a source file changes.</li>
<li>Support verbose output to show how long the bundling took.</li>
<li>Reload the dev server as soon as API bundle recompiled.</li>
<li>Send a desktop notification when the build fails.</li>
</ul></li>
<li>Build NPM package to provide APIs that runs on a web browser.</li>
</ul>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline4" class="outline-2">
<h2 id="orgheadline4">Project Folder Structures</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<div class="org-src-container">

<pre class="prettyprint" data-lang="bash">
$ tree hello-api
├── Makefile
├── README.md
├── api.js
├── dist
│   ├── babel
│   ├── release
│   └── ts
├── package.json
├── hello-api.tar.gz
├── server.js
├── src
├── test
├── tsconfig.json
├── tsconfig.prod.json
└── tslint.json
</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline5" class="outline-2">
<h2 id="orgheadline5">Getting Started</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
In GNU Make, you <b>must</b> start a command with a [tab] character.
</p>

<div class="org-src-container">

<pre class="prettyprint" data-lang="make">
$(TARGET): $(DEP1) $(DEP2) $(DEP3)
	# `$?` contains a list of dependencies.
	@echo $?
	# `$@` evaluates to current TARGET name.
	@echo $@
	@$(COMMAND1); $(COMMAND2); $(COMMAND3)
</pre>

</div>

<div class="org-src-container">

<pre class="prettyprint" data-lang="make">
.PHONY: build-babel
build-babel: $(JS_DIR)
	@$(RM) $(BABEL_DIR)
	@NODE_ENV=production $(BABEL) $(JS_DIR) -d $(BABEL_DIR)

$(BABEL_DIR): $(JS_DIR)
</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline6" class="outline-2">
<h2 id="orgheadline6">Variable Assignment</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Operator</th>
<th scope="col" class="left">Type</th>
<th scope="col" class="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">=</td>
<td class="left">Lazy Set</td>
<td class="left">Values within it are recursively expanded when the variable is used, not when it's declared.</td>
</tr>

<tr>
<td class="left">:=</td>
<td class="left">Immediate Set</td>
<td class="left">Values within it are expanded at declaration time.</td>
</tr>

<tr>
<td class="left">?=</td>
<td class="left">Set If Absent</td>
<td class="left">Setting of a variable only if it doesn't have a value.</td>
</tr>

<tr>
<td class="left">+=</td>
<td class="left">Append</td>
<td class="left">Appending the supplied value to the existing value.</td>
</tr>
</tbody>
</table>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline7" class="outline-2">
<h2 id="orgheadline7">Dependency Graph</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
You can create a graph of dependencies from GNU Make using makefile2graph.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Options</th>
<th scope="col" class="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">-B</td>
<td class="left">Unconditionally make all targets.</td>
</tr>

<tr>
<td class="left">-n</td>
<td class="left">Print the commands that would be executed, but do not execute them.</td>
</tr>

<tr>
<td class="left">-d</td>
<td class="left">Print debugging information in addition to normal processing.</td>
</tr>
</tbody>
</table>

<ul>
<li><code>make -Bnd build | make2graph | dot -Tpng -o make-build.png</code></li>
<li><a href="https://github.com/lindenb/makefile2graph">https://github.com/lindenb/makefile2graph</a></li>
</ul>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline8" class="outline-2">
<h2 id="orgheadline8"><code>make build</code></h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<article class="flexbox vcenter">

<div class="figure">
<p><img src="images/make-build.png" alt="make-build.png" width="100%" />
</p>
</div>
</article>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline9" class="outline-2">
<h2 id="orgheadline9"><code>make dist</code></h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<article class="flexbox vcenter">

<div class="figure">
<p><img src="images/make-dist.png" alt="make-dist.png" width="100%" />
</p>
</div>
</article>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline10" class="outline-2">
<h2 id="orgheadline10"><code>make watch</code></h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<article class="flexbox vcenter">

<div class="figure">
<p><img src="images/make-watch.png" alt="make-watch.png" width="100%" />
</p>
</div>
</article>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline11" class="outline-2">
<h2 id="orgheadline11">NPM scripts</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<div class="org-src-container">

<pre class="prettyprint" data-lang="json">
{
  "scripts": {
    "clean": "make clean",
    "distclean": "make distclean",
    "lint": "make lint",
    "build:ts": "make build-ts",
    "build:babel": "make build-babel",
    "build": "make build",
    "dist": "make dist",
    "watch": "make watch",
    "serve": "make serve",
    "start": "make start",
    "test": "make test",
    "release": "make release"
  }
}
</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline12" class="outline-2">
<h2 id="orgheadline12">Fetch Posts from Reddit</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
<code>index.ts</code>:
</p>

<div class="org-src-container">

<pre class="prettyprint" data-lang="typescript">
import { fetchPosts } from "./reddit";
export const reddit = { fetchPosts };
</pre>

</div>

<p>
<code>reddit.ts</code>:
</p>

<div class="org-src-container">

<pre class="prettyprint" data-lang="typescript">
export const fetchPosts = async (reddit: string) =&gt; {
  try {
    const json = validate(fetchPostsSchema, await get(`/r/${reddit}.json`).end());
    return json.data.children.map((child) =&gt; child.data);
  } catch (error) {
    throw error;
  }
};
</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline13" class="outline-2">
<h2 id="orgheadline13">API Dev server</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<ol>
<li><code>make watch &amp; make serve</code></li>
<li>Open <a href="http://localhost:3003/">http://localhost:3003/</a>.</li>
<li>Open JavaScript console (⌥⌘J).</li>
<li>Fetch <b>vuejs</b> reddits via <code>fetchPosts</code>.</li>
</ol>

<div class="org-src-container">

<pre class="prettyprint" data-lang="javascript">
api.reddit
  .fetchPosts('vuejs')
  .then(x =&gt; console.log(x));
</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline14" class="outline-2">
<h2 id="orgheadline14">Build <code>hello-api</code> NPM package</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<ol>
<li>Run <code>make dist</code> to build NPM package.</li>
<li>Run <code>tar tvf hello-api.tar.gz</code> to check the its content.</li>
</ol>

<div class="org-src-container">

<pre class="prettyprint" data-lang="bash">
drwxr-xr-x  0 carlsu staff       0 11  8 17:51 ./
-rw-r--r--  0 carlsu staff     210 11  8 17:51 ./index.js
-rw-r--r--  0 carlsu staff    1169 11  8 17:51 ./package.json
-rw-r--r--  0 carlsu staff    2506 11  8 17:51 ./reddit.js
-rw-r--r--  0 carlsu staff    2349 11  8 17:51 ./reddit.schema.js
drwxr-xr-x  0 carlsu staff       0 11  8 17:51 ./utils/
-rw-r--r--  0 carlsu staff    5725 11  8 17:51 ./utils/agent.js
-rw-r--r--  0 carlsu staff    1289 11  8 17:51 ./utils/index.js
</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-" class=" segue dark quote nobackground" style="background-image: url(nil)">
<aside class="gdbar right bottom"><img src="images/vue.svg"></aside><hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline15" class="outline-2">
<h2 id="orgheadline15">Example 2: Hello Reddit App</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="flexbox vleft auto-fadein" id="text-">


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline16" class="outline-2">
<h2 id="orgheadline16">Add Hello API Example to NPM dependencies</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
This package comes from Hello API dev server which built with <code>make dist</code>.
</p>

<p>
Add <code>hello-api</code> to NPM dependencies and install it immediately.
</p>

<p>
<code>package.json</code>:
</p>

<div class="org-src-container">

<pre class="prettyprint" data-lang="json">
"dependencies": {
    "hello-api": "http://localhost:3003/hello-api.tar.gz"
}
</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline17" class="outline-2">
<h2 id="orgheadline17">Fetch Posts from Reddit</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<p>
<code>src/sagas/index.js</code>:
</p>

<div class="org-src-container">

<pre class="prettyprint" data-lang="javascript">
import { reddit as redditApi } from 'hello-api';
export function* fetchPosts(reddit) {
  yield put(requestPosts({reddit}));
  const posts = yield call(redditApi.fetchPosts, reddit);
  yield put(receivePosts({
    reddit,
    posts,
    receivedAt: Date.now()
  }));
}
</pre>

</div>


</article>

</slide>

</slide>
<slide id="sec-"  >
<hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline18" class="outline-2">
<h2 id="orgheadline18">Start the App</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">
<ol>
<li>Run <code>npm install</code> to install the package we just built.</li>
<li>Run <code>npm start</code> to start the app.</li>
<li>Open <a href="http://localhost:3000/">http://localhost:3000/</a> to see if it works.</li>
</ol>


</article>

</slide>

</slide>
<slide id="sec-" class=" segue dark quote nobackground" style="background-image: url(nil)">
<aside class="gdbar "><img src="images/vue.svg"></aside><hgroup class="">
       <h2 class=" "><div id="outline-container-orgheadline19" class="outline-2">
<h2 id="orgheadline19">Thank you!</h2>
</div>
</h2>
       <h3></h3>
       </hgroup>
<article class="" id="text-">


</article>

</slide>
<slide class="backdrop"></slide>
</slides> 
<!--[if IE]>
  <script src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
  <script>CFInstall.check({mode: 'overlay'});</script>
<![endif]-->
</body> 

</html>
